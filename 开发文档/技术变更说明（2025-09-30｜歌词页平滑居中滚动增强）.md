## 2025-09-30｜歌词页平滑居中滚动增强
(TechChangeSpec_2025-09-30-Lyrics-SmoothCentering)

### 方案总览与实现要点
- 在不改动现有“行切换与居中定位逻辑”的前提下，仅当目标歌词行仍在 RecyclerView 可见区域内时，将一次性硬切居中改为短程平滑滚动；跨屏或不可见保持硬切。
- 改动集中于 `LyricsController.centerTo()`；读取偏好与省电模式，计算同屏偏移，阈值小于等于 2px 则忽略。

### 问题回溯与根因分析
- 现状：仅字号/内边距有平滑过渡，列表定位仍为硬切，导致切行时视觉跳变。
- 目标：同屏小位移使用短程平滑滚动，保留鲁棒性与性能边界。

### 受影响文件与关键点
- `app/src/main/java/com/watch/limusic/LyricsController.java`：`centerTo(int idx)` 增加“同屏短程平滑滚动”逻辑与偏好读取。
- 参考：`app/src/main/java/com/watch/limusic/adapter/LyricsAdapter.java`：使用高度估算保证动画前居中偏移合理。

### 版本信息与变更摘要
- 版本：v4.0Beta4（2025-09-30，歌词页平滑居中滚动增强）
- 摘要：同屏小位移平滑滚动，跨屏硬切；与字号/内边距过渡并行，整体过渡更自然。

### 验收用例与验收标准（手表优先）
- 开启“歌词平滑过渡”：可见区内切行出现轻微平滑滚动且最终居中；跨屏硬切；手动滚动时自动回中不被打断。

### 性能与功耗评估
- 仅同屏短程触发，额外负载极小；跨屏硬切避免长距离动画对低性能设备产生卡顿；省电模式下强制关闭。

### 风险与回滚
- 风险：平滑滚动与 UI 过渡时序导致一次轻微二次居中感知。
- 回滚：关闭 `lyric_smooth_enabled` 即恢复原行为。

### 回归测试要点
- 切行与用户手势互斥逻辑正确；滚动阈值与二次居中校正生效；老设备行为一致。

### 行为修正（2025-09-30 后续调整）
- 修复：`SCROLL_STATE_SETTLING` 误判为“用户浏览中”导致回中被抑制的问题；仅在 `DRAGGING` 标记用户浏览。
- 增强：切行允许自动回中时新增 16ms 延迟二次居中校正，确保放大/内边距变化后的精准居中。